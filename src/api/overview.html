<!DOCTYPE html>
<!--
    This document should be written in polyglot HTML5/XHTML5, and therefore
    should run when served either as text/html or application/xhtml+xml.
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>

    <meta charset="utf-8" />
    <title>Active games</title>
    <link rel="stylesheet" href="jquery-ui.css" />
    <link rel="stylesheet" href="gui.css" />

</head>

<body>
    <div class="title2">Active games</div>

    <br />

    <div>
        <table>
            <thead>
                <tr>
                <td>Game #</td>
                <td>Opponent</td>
                <td>Your button</td>
                <td>Opponent's button</td>
                <td>Score</td>
                <td>Status</td>
                </tr>
            </thead>
            <tbody id="active_games">

            </tbody>
        </table>
    </div>

    <!--
    james: eventually, we will want to use the hosted version of the JQuery library
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    -->
    <script src="jquery-1.9.0.min.js"></script>
    <script>
        $(document).ready(function() {
            // global variables
            var message = '';

            // functions
            function loadActiveGames() {
                $.post('responder.php',
                       {type: 'loadActiveGames'},
                       function(rs){
                           // add buttons to selects
                           for (var gameIdx = 0;
                                gameIdx < rs.gameIdArray.length;
                                gameIdx++) {
//                               var gameId = rs.gameArray[buttonIdx];
//                               var recipe = rs.recipeArray[buttonIdx];
                               $('#active_games').append(
                                 '<tr>' +
                                     '<td>'  +
                                         rs.gameIdArray[gameIdx] +
                                     '</td>' +
                                     '<td>'  +
                                         rs.opponentNameArray[gameIdx] +
                                     '</td>' +
                                     '<td>'  +
                                         rs.myButtonNameArray[gameIdx] +
                                     '</td>' +
                                     '<td>'  +
                                         rs.opponentButtonNameArray[gameIdx] +
                                     '</td>' +
                                     '<td>'  +
                                         rs.nWinsArray[gameIdx]       + ' / ' +
                                         rs.nDrawsArray[gameIdx]      + ' / ' +
                                         rs.nLossesArray[gameIdx]     + ' ('  +
                                         rs.nTargetWinsArray[gameIdx] + ')' +
                                     '</td>' +
                                     '<td>'  +
                                         rs.statusArray[gameIdx] +
                                     '</td>' +
                                 '</tr>'
                               );
                           }
                           message = rs.message;
                       });
            }

            // code to run when page is ready
            loadActiveGames();
        });
    </script>
</body>
</html>
